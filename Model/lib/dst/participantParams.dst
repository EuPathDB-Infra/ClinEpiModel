[templateStart]
name=participantFilterParams
anchorFile=ClinEpiModel/Model/lib/wdk/model/questions/params/participantParams.xml
prop=injectedTemplateFull
>templateTextStart<
${injectedTemplateFull}
>templateTextEnd<

[templateStart]
name=participantFilterParamsRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.RegionOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.RegionMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Households"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_${paramSuffix}"
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>
       
       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef="participantParams.geographic_region_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix},participantParams.geographic_region_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=regionFilterExcludedIdsQuoted
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

   <sqlQuery name="RegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name,
o.description, o.variable_name, o.units,o.type,o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in ('GAZ_00000448')
     and ontology_term_name not in (${regionFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct h.household_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
     and h.ontology_term_name not in (${regionFilterExcludedIdsQuoted})
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or hp.participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="RegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct h.household_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     and h.ontology_term_name not in (${regionFilterExcludedIdsQuoted})
and h.household_id = hp.household_id 
        ]]>
      </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where hp.participant_id in (\$\$geographic_region_${paramSuffix}\$\$)
and h.household_id = hp.household_id 
     and h.ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
     and h.ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where \$\$households_${paramSuffix}.filters_present\$\$ = 1
and participant_id in (\$\$households_${paramSuffix}\$\$)
UNION ALL
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where \$\$households_${paramSuffix}.filters_present\$\$ = 0
and participant_id in (\$\$geographic_region_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
     <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<


[templateStart]
name=participantFilterParamsHousehold
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef="participantParams.study_arm_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=microbiomeOntologyQuery
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=MicrobiomeDatasetName
>templateTextStart<
UNION
select 'microbiome_results' as ontology_term_name,
'EUPATH_0000609' as parent_ontology_term_name,
'Microbiome Results' as display_name,
'Results from MicrobiomeDB' as description,
cast(null as varchar2(1)) as type, cast(null as varchar2(1)) as units,
1 as precision, 0 as is_range,
100 as display_order
FROM dual
UNION
select category as ontology_term_name,
'microbiome_results' as parent_ontology_term_name,
category as display_name,
'taxonomic rank' as description,
cast(null as varchar2(1)) as type, cast(null as varchar2(1)) as units,
1 as precision, 0 as is_range,
taxon_level * 2 - 1 as display_order
from apidbTuning.TaxonAbundance@clin2mbio
where dataset_name = '${MicrobiomeDatasetName}'
UNION
select term_id as ontology_term_name,
category as parent_ontology_term_name,
term as display_name,
cast(null as varchar2(1)) as description,
'number' as type, null as units, 1 as precision, 1 as is_range,
taxon_level * 2 as display_order
from apidbTuning.TaxonAbundance@clin2mbio
where dataset_name = '${MicrobiomeDatasetName}'
>templateTextEnd<

[templateStart]
name=participantMicrobiomeMetadataQuery
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=MicrobiomeDatasetName
prop=tblPrefix
prop=paramSuffix
>templateTextStart<
UNION ALL
select idmap.participant_id as internal, idmap.sub_observation_id as filter_item_id,
ta.term_id as ontology_term_name,
cast(null as varchar2(1)) as string_value,
cast(ta.value as number) as number_value,
cast(null as date) as date_value
from apidbTuning.TaxonAbundance@clin2mbio ta, apidbTuning.SampleProcess@clin2mbio sp, apidbTuning.Samples@clin2mbio sa,
(select distinct participant_id,sub_observation_id, number_value as splid from apidbtuning.${tblPrefix}ObservationMD where ontology_term_name = 'OBI_0001616'
and participant_id in (\\\$\\\$participant_${paramSuffix}\\\$\\\$)) idmap
where ta.dataset_name = '${MicrobiomeDatasetName}'
and ta.protocol_app_node_id = sp.output_pan_id
AND sp.output_isa_type = 'Data'
and sa.pan_id = sp.protocol_app_node_id
and idmap.splid = sa.EUPATH_0009017
>templateTextEnd<

[templateStart]
name=participantMicrobiomeMetadataBkgQuery
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=MicrobiomeDatasetName
prop=tblPrefix
prop=paramSuffix
>templateTextStart<
UNION ALL
select idmap.participant_id as internal, idmap.sub_observation_id as filter_item_id, 
ta.term_id as ontology_term_name,
cast(null as varchar2(1)) as string_value,
cast(ta.value as number) as number_value,
cast(null as date) as date_value
from apidbTuning.TaxonAbundance@clin2mbio ta, apidbTuning.SampleProcess@clin2mbio sp, apidbTuning.Samples@clin2mbio sa,
(select distinct participant_id,sub_observation_id, number_value as splid from apidbtuning.${tblPrefix}ObservationMD where ontology_term_name = 'OBI_0001616') idmap
where ta.dataset_name = '${MicrobiomeDatasetName}'
and ta.protocol_app_node_id = sp.output_pan_id
AND sp.output_isa_type = 'Data'
and sa.pan_id = sp.protocol_app_node_id
and idmap.splid = sa.EUPATH_0009017
>templateTextEnd<

[templateStart]
name=participantFilterParamQueries
anchorFile=ClinEpiModel/Model/lib/wdk/model/questions/params/participantParams.xml
prop=injectedTemplateFull
>templateTextStart<
${injectedTemplateFull}
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesHousehold
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or hp.participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
     ${rmRegionSqlCommentStart}
     and h.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
     ${rmRegionSqlCommentStart}
     and h.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<


[templateStart]
name=participantFilterParamsParticipant
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.study_arm_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesParticipant
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted},${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000096','PCO_0000024')
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted},${householdFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
UNION
select hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or hp.participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantMetaDataBkg_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
UNION
select hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<


[templateStart]
name=participantFilterParamsWithTreatment
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="participants_${paramSuffix}" 
                      ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                      metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                      backgroundQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                      countPredictsAnswerCount="true"
                      filterDataTypeDisplayName="Participants"
                      prompt="Personal characteristics"
                      trimMetadataTerms="${trimParticipantMetadataTerms}"
                      dependedParamRef="">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                       countPredictsAnswerCount="true"
                       prompt="Observations"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>

       <filterParam name="treatment_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.TreatmentOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.TreatmentMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.TreatmentMetaDataBkgd_${paramSuffix}"
                       countPredictsAnswerCount="true"
                       prompt="Observations"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       dependedParamRef="participantParams.visits_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>

    <filterParam name="relative_visits_${paramSuffix}" 
                    metadataQueryRef="ParticipantVQ.RelVisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.RelVisitMetaData_${paramSuffix}"
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
      <help>
        Select related observations based on their characteristics. 
      </help>
    </filterParam>

       <filterParam name="relative_treatment_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.TreatmentOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.RelativeTreatmentMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.TreatmentMetaDataBkgd_${paramSuffix}"
                       countPredictsAnswerCount="false"
                       prompt="Observations"
                       trimMetadataTerms="true"
                       dependedParamRef="participantParams.relative_visits_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesWithTreatment
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
>templateTextStart<
   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'EUPATH_0000096'
     UNION
     select distinct ontology_term_source_id as ontology_term_name, 'EUPATH_0000096' as parent_ontology_term_name, nvl(display_name,ontology_term_name) as display_name, description, variable_name, units,type,is_range,precision, 0.5 as display_order
     from ApidbTuning.${tblPrefix}Ontology 
     where ontology_term_source_id in ('EUPATH_0021095','EUPATH_0021094')
     )
     where ontology_term_name != 'EUPATH_0000095'
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id not in ('29082466','29082990')
UNION
select io.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h,  ApidbTuning.${tblPrefix}HousePartIO io
where h.household_id = io.household_id
and h.household_id not in ('29082466','29082990')
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in  ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     and ontology_term_name not in (select distinct ontology_term_name
from ApidbTuning.${tblPrefix}ObservationMD
where sub_observation_id in (select distinct sub_observation_id from ApidbTuning.${tblPrefix}ObsObsIO))
     order by display_order,display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
and sub_observation_id not in (select distinct sub_observation_id from ApidbTuning.${tblPrefix}ObsObsIO)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where sub_observation_id not in (select distinct sub_observation_id from ApidbTuning.${tblPrefix}ObsObsIO)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="TreatmentOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
o.type, o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}ObservationMD md, ApidbTuning.${tblPrefix}Ontology o
where md.sub_observation_id in (select distinct sub_observation_id from ApidbTuning.${tblPrefix}ObsObsIO)
and o.ontology_term_source_id = Md.Ontology_Term_Name)
order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="TreatmentMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.visits_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where observation_id in (\$\$visits_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="TreatmentMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="RelVisitMetaData_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where sub_observation_id not in (select distinct sub_observation_id from ApidbTuning.${tblPrefix}ObsObsIO)
          ]]>
    </sql>
    </sqlQuery>
   
       <sqlQuery name="RelativeTreatmentMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.relative_visits_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where observation_id in (\$\$relative_visits_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    
>templateTextEnd<

[templateStart]
name=participantFilterParamsCaseControlRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="case_control_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.CaseControlOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.CaseControlMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.CaseControlMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_${paramSuffix}"
                    trimMetadataTerms="true">

         <help>
           Select participants based on whether they are cases or controls. 
         </help>
       </filterParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.GeographicRegionOntology_${paramSuffix}" 
                       metadataQueryRef="ParticipantVQ.GeographicRegionMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.GeographicRegionMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Participants"
                       prompt="Study Site"
                       trimMetadataTerms="true"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.case_control_filter_${paramSuffix}">
         <help>
           Select participants based on their study site.
         </help>
       </filterParam>

       <filterParam name="household_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                       prompt="Household"
                       trimMetadataTerms="${trimHouseholdMetadataTerms}"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.geographic_region_${paramSuffix}">
         <help>
           Select participants based on household characteristics. 
         </help>
       </filterParam>
       
       <filterParam name="participant_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Participants"
                       prompt="Participant"
                       trimMetadataTerms="${trimParticipantMetadataTerms}"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.household_${paramSuffix}">
         <help>
           Select participants based on their personal characteristics. 
         </help>
       </filterParam>

       <filterParam name="event_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ObservationOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.ObservationMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ObservationMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Observations"
                       prompt="Observations"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       countPredictsAnswerCount="false"
                       dependedParamRef="participantParams.participant_${paramSuffix}">
         <help>
           Select participants based on variables associated with their enrollment or followup events. 
         </help>
       </filterParam>       

      <filterParam name="relative_event_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ObservationOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.RelativeCasecontrolObservationMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ObservationMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Observations"
                       prompt="Related Case or Control"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       countPredictsAnswerCount="false"
                       dependedParamRef="participantParams.case_control_filter_${paramSuffix}">
         <help>
           Modify participants selected based on information about their related case or control. 
         </help>
       </filterParam>    
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesCaseControlRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
prop=microbiomeOntologyQueryFull
prop=participantMicrobiomeMetadataQueryFull
prop=participantMicrobiomeMetadataBkgQueryFull
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

    <sqlQuery name="CaseControlOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     where ontology_term_source_id = 'EUPATH_0010375')
          ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="CaseControlMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal,  ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0010375'
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="CaseControlMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal,  ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0010375'
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="GeographicRegionOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in ('GAZ_00000448')
     order by display_order, display_name
          ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="GeographicRegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.case_control_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.household_id as internal, hp.participant_id as record_id,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and m.household_id = hp.household_id 
and hp.participant_id in (\$\$case_control_filter_${paramSuffix}\$\$)
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="GeographicRegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.household_id as internal, hp.participant_id as record_id,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and m.household_id = hp.household_id  
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="HouseholdOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,o.is_range,o.precision,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'PCO_0000024'
) where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
                  select hp.participant_id as internal,  m.household_observation_id as filter_item_id,
                  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where hp.household_id in (\$\$geographic_region_${paramSuffix}\$\$)
and m.household_id = hp.household_id 
and m.ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and m.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select hp.participant_id as internal,  m.household_observation_id as filter_item_id,
                  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.household_id = hp.household_id 
and m.ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and m.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ParticipantOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'EUPATH_0000096'
) where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.household_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
where m.participant_id in (\$\$household_${paramSuffix}\$\$)
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ObservationOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, 
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type, 
o.variable_name, o.units, o.precision, o.is_range, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in  ('EUPATH_0000738','EUPATH_0000609')
${microbiomeOntologyQueryFull}
) where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="ObservationMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.participant_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participant_${paramSuffix}\$\$)
${participantMicrobiomeMetadataQueryFull}
          ]]>
    </sql>    
    </sqlQuery>

    <sqlQuery name="ObservationMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
${participantMicrobiomeMetadataBkgQueryFull}
          ]]>
    </sql>    
    </sqlQuery>

    <sqlQuery name="RelativeCasecontrolObservationMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.case_control_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id not in (\$\$case_control_filter_${paramSuffix}\$\$)
          ]]>
    </sql>    
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsPRISM
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="geographic_region_prism" 
                       ontologyQueryRef="ParticipantVQ.RegionOntology_prism"
                       metadataQueryRef="ParticipantVQ.RegionMetaData_prism"
                       backgroundQueryRef="ParticipantVQ.RegionMetaData_prism"
                       filterDataTypeDisplayName="Households"
                       prompt="Geographic region"
                       countPredictsAnswerCount="true"
                       trimMetadataTerms="true"
                       dependedParamRef="">
         <help>
           Select participants based on their geographic region. 
         </help>
    </filterParam>

    <filterParam name="visits_visitage_metadata_prism" 
                    ontologyQueryRef="ParticipantVQ.VisitAgeOntology_prism"
                    metadataQueryRef="ParticipantVQ.VisitAgeMetaData_prism"
                    backgroundQueryRef="ParticipantVQ.VisitAgeMetaDataBkgd_prism"
                    countPredictsAnswerCount="false"
                    prompt="Age at visit"
                    filterDataTypeDisplayName="Participants"
                    dependedParamRef="participantParams.geographic_region_prism"
                    trimMetadataTerms="true">
      <help>
        Select reference samples. 
      </help>
    </filterParam>
    
    <filterParam name="participants_prism" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_prism"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_prism"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_prism"
                    countPredictsAnswerCount="true"
                    prompt="Participants"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_prism,clinicalVisitParams.visit_date,participantParams.duration_observation,participantParams.geographic_region_prism">
      <help>
        Select participants based on their characteristics. 
      </help>
    </filterParam>


    <filterParam name="households_prism" 
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_prism"
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_prism"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_prism"
                    filterDataTypeDisplayName="Households"
                    countPredictsAnswerCount="true"
                    prompt="Households"
                    dependedParamRef="clinicalVisitParams.visit_date,participantParams.participants_prism"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
      <help>
        Select participants based on the characteristics of the household where they live. 
      </help>
    </filterParam>

    <filterParam name="visits_prism" 
                    metadataQueryRef="ParticipantVQ.VisitMetaData_prism"
                    ontologyQueryRef="ParticipantVQ.VisitOntology_prism"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_prism"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_prism,participantParams.households_prism,clinicalVisitParams.visit_date">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>

        <filterParam name="relative_visits_prism" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_prism"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_prism"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_prism"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>
>templateTextEnd<

[templateStart]
name=participantFilterParamsEntomolRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="geographic_region_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.RegionOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                       filterDataTypeDisplayName="Households"
                       prompt="Geographic region"
                       countPredictsAnswerCount="true"
                       trimMetadataTerms="true"
                       dependedParamRef="">
         <help>
           Select participants based on their geographic region. 
         </help>
    </filterParam>

    <filterParam name="visits_visitage_metadata_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitAgeOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitAgeMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitAgeMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Age at visit"
                    filterDataTypeDisplayName="Participants"
                    dependedParamRef="participantParams.geographic_region_${paramSuffix}"
                    trimMetadataTerms="true">
      <help>
        Select reference samples. 
      </help>
    </filterParam>
    
    <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    prompt="Participants"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_${paramSuffix},clinicalVisitParams.visit_date,participantParams.duration_observation,participantParams.geographic_region_${paramSuffix}">
      <help>
        Select participants based on their characteristics. 
      </help>
    </filterParam>


    <filterParam name="households_${paramSuffix}" 
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_${paramSuffix}"
                    filterDataTypeDisplayName="Households"
                    countPredictsAnswerCount="true"
                    prompt="Households"
                    dependedParamRef="clinicalVisitParams.visit_date,participantParams.participants_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
      <help>
        Select participants based on the characteristics of the household where they live. 
      </help>
    </filterParam>

    <filterParam name="visits_${paramSuffix}" 
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_${paramSuffix},participantParams.households_${paramSuffix},clinicalVisitParams.visit_date">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>

        <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>
>templateTextEnd<

[templateStart]
name=participantFilterParamsPRISM2
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
    <filterParam name="visits_visitage_metadata_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitAgeOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitAgeMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitAgeMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Age at visit"
                    filterDataTypeDisplayName="Participants"
                    dependedParamRef=""
                    trimMetadataTerms="true">
      <help>
        Select reference samples. 
      </help>
    </filterParam>
    
    <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    prompt="Participants"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_${paramSuffix},clinicalVisitParams.visit_date,participantParams.duration_observation">
      <help>
        Select participants based on their characteristics. 
      </help>
    </filterParam>


    <filterParam name="households_${paramSuffix}" 
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_${paramSuffix}"
                    filterDataTypeDisplayName="Households"
                    countPredictsAnswerCount="true"
                    prompt="Households"
                    dependedParamRef="clinicalVisitParams.visit_date,participantParams.participants_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
      <help>
        Select participants based on the characteristics of the household where they live. 
      </help>
    </filterParam>

    <filterParam name="visits_${paramSuffix}" 
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.visits_visitage_metadata_${paramSuffix},participantParams.households_${paramSuffix},clinicalVisitParams.visit_date">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>

        <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
      <help>
        Select participants based on their visit characteristics. 
      </help>
    </filterParam>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesPRISM
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
   <sqlQuery name="RegionOntology_prism" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
where ontology_term_source_id = 'EUPATH_0000054'
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_prism" isCacheable="false" >
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
  select distinct m.household_id as filter_item_id,  io.participant_id as internal, m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO io
 where m.ontology_term_name = 'EUPATH_0000054'
 and io.household_id = m.household_id
        ]]>
      </sql>
    </sqlQuery>

       <sqlQuery name="VisitAgeOntology_prism" isCacheable="true">
         <column name="ontology_term_name"/>
         <column name="parent_ontology_term_name"/>
         <column name="display_name"/>
         <column name="description"/>
         <column name="variable_name"/>
         <column name="type"/>
         <column name="units"/>
         <column name="precision"/>
         <column name="is_range"/>
         <sql>
           <![CDATA[
                       select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
where ontology_term_source_id = 'EUPATH_0000113'
    ]]>   
        </sql>
      </sqlQuery>
          
      <sqlQuery name="VisitAgeMetaData_prism" isCacheable="false">
        <paramRef ref="participantParams.geographic_region_prism" /> 
        <column name="ontology_term_name"/>
        <column name="internal"/>
        <column name="number_value"/>
        <column name="date_value"/>
        <column name="string_value"/>
        <sql>
          <![CDATA[
 select m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from  ApidbTuning.${tblPrefix}ObservationMD m
  where m.participant_id in (\$\$geographic_region_prism\$\$)
  and m.ontology_term_name = 'EUPATH_0000113'
         ]]>   
      </sql>
   </sqlQuery>

      <sqlQuery name="VisitAgeMetaDataBkgd_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
  select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ObservationMD m
where m.ontology_term_name = 'EUPATH_0000113'
          ]]>   
      </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantOntology_prism" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
) order by display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_prism" isCacheable="false">
     <paramRef ref="participantParams.visits_visitage_metadata_prism" />
     <paramRef ref="clinicalVisitParams.visit_date" /> 
     <paramRef ref="participantParams.duration_observation" />  
     <paramRef ref="participantParams.geographic_region_prism" />  
     <column name="ontology_term_name"/>
     <column name="internal"/>
     <column name="number_value"/>
     <column name="date_value"/>
     <column name="string_value"/>
     <sql>
       <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
  from (select min(EUPATH_0000113) as min_age, max(EUPATH_0000113) as max_age
   from ApidbTuning.${tblPrefix}Observations 
   where pan_id in (\$\$visits_visitage_metadata_prism\$\$)
   ) age,
   ApidbTuning.${tblPrefix}Participants pa, ApidbTuning.${tblPrefix}PartObsIO iov, ApidbTuning.${tblPrefix}ParticipantMD m, ApidbTuning.${tblPrefix}Observations obs
   where least(pa.EUPATH_0000152, \$\$visit_date.max\$\$, pa.EFO_0004950 + ( age.max_age * 365)) - 
       greatest(pa.EUPATH_0000151, \$\$visit_date.min\$\$, pa.EFO_0004950 + ( age.min_age * 365)) + 1 >= \$\$duration_observation\$\$
       and obs.pan_id in (\$\$visits_visitage_metadata_prism\$\$)
       and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
       and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
       and iov.observation_id = obs.pan_id
       and pa.pan_id = iov.participant_id
       and pa.pan_id = m.participant_id       
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdOntology_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in ('EUPATH_0000144') AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('PCO_0000024','ENVO_01000744')
 union
 select 'average_anopheles' as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, 'Average Female Anopheles Collected' as display_name, 'Average number of female Anopheles mosquitoes collected per house per night using CDC light traps set up once a month during the dates of this search' as description, null as variable_name, null as units, 'number' as type, 1 as is_range,
 null as precision from dual)
 where ontology_term_name not in ('EUPATH_0000094')
 order by display_name
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaData_prism" isCacheable="false">
      <paramRef ref="clinicalVisitParams.visit_date" /> 
      <paramRef ref="participantParams.participants_prism" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from  ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_id in (\$\$participants_prism\$\$)
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
 union all
 select distinct part.household_id as filter_item_id, part.part_id as internal, 'average_anopheles' as ontology_term_name, null as string_value, nvl(mos.avg_anoph,0) as number_value, null as date_value
 from (select da.pan_id, round(avg(nvl(EUPATH_0000192,0)+nvl(EUPATH_0000204,0)+nvl(EUPATH_0000205,0)),1) as avg_anoph
  from ApidbTuning.${tblPrefix}Households da, ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}LightTraps la
  where da.pan_id = io.input_pan_id
  and la.pan_id = io.output_pan_id
  and la.EUPATH_0020003 >= \$\$visit_date.min\$\$ 
  and la.EUPATH_0020003 <= \$\$visit_date.max\$\$ 
  group by da.pan_id) mos, part
  where part.household_id = mos.pan_id(+)
          ]]>
    </sql>    

    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
  with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_type_source_id = 'EUPATH_0000096'
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
 union all
 select distinct part.household_id as filter_item_id, part.part_id as internal, 'average_anopheles' as ontology_term_name, null as string_value, nvl(mos.avg_anoph,0) as number_value, null as date_value
 from (select io.input_pan_id as pan_id, round(avg(nvl(EUPATH_0000192,0)+nvl(EUPATH_0000204,0)+nvl(EUPATH_0000205,0)),1) as avg_anoph
  from ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}LightTraps la
  where io.input_pan_type_source_id = 'PCO_0000024'
  and io.output_pan_type_source_id = 'EUPATH_0000327'
  and la.pan_id = io.output_pan_id
  group by io.input_pan_id) mos, part
  where part.household_id = mos.pan_id(+)
          ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="VisitOntology_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in ('EUPATH_0021002') AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name != 'EFO_0004950'
     order by display_name
        ]]>
      </sql>
    </sqlQuery>

       <sqlQuery name="VisitMetaData_prism" isCacheable="false">
         <paramRef ref="participantParams.visits_visitage_metadata_prism" />
         <paramRef ref="clinicalVisitParams.visit_date" /> 
         <paramRef ref="participantParams.households_prism" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
with valid as (
select distinct io.output_pan_id as visit_id, io.input_pan_id as part_id
from ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}Observations obs
where io.input_pan_id in (\$\$households_prism\$\$)
and io.output_pan_id in (\$\$visits_visitage_metadata_prism\$\$)
and obs.pan_id = io.output_pan_id
and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
)
select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}ObservationMD m, valid
 where m.observation_id = valid.visit_id
/*
  union all
 select valid.visit_id as internal,  m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}MetaData m, valid, ApidbTuning.${tblPrefix}PANIO ios
where m.property_source_id = 'OBI_0100051'
and ios.output_pan_id = m.pan_id
and ios.input_pan_id = valid.visit_id
*/
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_prism" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesEntomolRegion
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
   <sqlQuery name="RegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
where ontology_term_source_id = 'EUPATH_0000054'
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_${paramSuffix}" isCacheable="false" >
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
  select m.household_id as filter_item_id,  io.participant_id as internal, m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO io
 where m.ontology_term_name = 'EUPATH_0000054'
 and io.household_id = m.household_id
        ]]>
      </sql>
    </sqlQuery>

       <sqlQuery name="VisitAgeOntology_${paramSuffix}" isCacheable="true">
         <column name="ontology_term_name"/>
         <column name="parent_ontology_term_name"/>
         <column name="display_name"/>
         <column name="description"/>
         <column name="variable_name"/>
         <column name="type"/>
         <column name="units"/>
         <column name="precision"/>
         <column name="is_range"/>
         <sql>
           <![CDATA[
                       select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
where ontology_term_source_id = 'EUPATH_0000113'
    ]]>   
        </sql>
      </sqlQuery>
          
      <sqlQuery name="VisitAgeMetaData_${paramSuffix}" isCacheable="false">
        <paramRef ref="participantParams.geographic_region_${paramSuffix}" /> 
        <column name="ontology_term_name"/>
        <column name="internal"/>
        <column name="number_value"/>
        <column name="date_value"/>
        <column name="string_value"/>
        <sql>
          <![CDATA[
 select m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from  ApidbTuning.${tblPrefix}ObservationMD m
  where m.participant_id in (\$\$geographic_region_${paramSuffix}\$\$)
  and m.ontology_term_name = 'EUPATH_0000113'
         ]]>   
      </sql>
   </sqlQuery>

      <sqlQuery name="VisitAgeMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
  select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ObservationMD m
where m.ontology_term_name = 'EUPATH_0000113'
          ]]>   
      </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
) order by display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.visits_visitage_metadata_${paramSuffix}" />
     <paramRef ref="clinicalVisitParams.visit_date" /> 
     <paramRef ref="participantParams.duration_observation" />  
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
     <column name="internal"/>
     <column name="number_value"/>
     <column name="date_value"/>
     <column name="string_value"/>
     <sql>
       <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
  from (select min(EUPATH_0000113) as min_age, max(EUPATH_0000113) as max_age
   from ApidbTuning.${tblPrefix}Observations 
   where pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
   ) age,
   ApidbTuning.${tblPrefix}Participants pa, ApidbTuning.${tblPrefix}PartObsIO iov, ApidbTuning.${tblPrefix}ParticipantMD m, ApidbTuning.${tblPrefix}Observations obs
   where least(pa.EUPATH_0000152, \$\$visit_date.max\$\$, pa.EFO_0004950 + ( age.max_age * 365)) - 
       greatest(pa.EUPATH_0000151, \$\$visit_date.min\$\$, pa.EFO_0004950 + ( age.min_age * 365)) + 1 >= \$\$duration_observation\$\$
       and obs.pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
       and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
       and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
       and iov.observation_id = obs.pan_id
       and pa.pan_id = iov.participant_id
       and pa.pan_id = m.participant_id       
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
     order by display_order, display_name
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="clinicalVisitParams.visit_date" /> 
      <paramRef ref="participantParams.participants_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from  ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_id in (\$\$participants_${paramSuffix}\$\$)
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
     ${rmRegionSqlCommentStart}
     and m.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
    </sql>    

    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
  with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_type_source_id = 'EUPATH_0000096'
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
     ${rmRegionSqlCommentStart}
     and m.ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
          ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_name
        ]]>
      </sql>
    </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.visits_visitage_metadata_${paramSuffix}" />
         <paramRef ref="clinicalVisitParams.visit_date" /> 
         <paramRef ref="participantParams.households_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
with valid as (
select distinct io.output_pan_id as visit_id, io.input_pan_id as part_id
from ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}Observations obs
where io.input_pan_id in (\$\$households_${paramSuffix}\$\$)
and io.output_pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
and obs.pan_id = io.output_pan_id
and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
)
select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}ObservationMD m, valid
 where m.observation_id = valid.visit_id
/*
  union all
 select valid.visit_id as internal,  m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}MetaData m, valid, ApidbTuning.${tblPrefix}PANIO ios
where m.property_source_id = 'OBI_0100051'
and ios.output_pan_id = m.pan_id
and ios.input_pan_id = valid.visit_id
*/
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesPRISM2
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
>templateTextStart<
       <sqlQuery name="VisitAgeOntology_${paramSuffix}" isCacheable="true">
         <column name="ontology_term_name"/>
         <column name="parent_ontology_term_name"/>
         <column name="display_name"/>
         <column name="description"/>
         <column name="variable_name"/>
         <column name="type"/>
         <column name="units"/>
         <column name="precision"/>
         <column name="is_range"/>
         <sql>
           <![CDATA[
                       select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision
from ApidbTuning.${tblPrefix}Ontology o
where ontology_term_source_id = 'EUPATH_0000113'
    ]]>   
        </sql>
      </sqlQuery>
          
      <sqlQuery name="VisitAgeMetaData_${paramSuffix}" isCacheable="false">
        <column name="ontology_term_name"/>
        <column name="internal"/>
        <column name="number_value"/>
        <column name="date_value"/>
        <column name="string_value"/>
        <sql>
          <![CDATA[
 select m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from  ApidbTuning.${tblPrefix}ObservationMD m
  where m.ontology_term_name = 'EUPATH_0000113'
         ]]>   
      </sql>
   </sqlQuery>

      <sqlQuery name="VisitAgeMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
  select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ObservationMD m
where m.ontology_term_name = 'EUPATH_0000113'
          ]]>   
      </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.visits_visitage_metadata_${paramSuffix}" />
     <paramRef ref="clinicalVisitParams.visit_date" /> 
     <paramRef ref="participantParams.duration_observation" />  
     <column name="ontology_term_name"/>
     <column name="internal"/>
     <column name="number_value"/>
     <column name="date_value"/>
     <column name="string_value"/>
     <sql>
       <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
  from (select min(EUPATH_0000113) as min_age, max(EUPATH_0000113) as max_age
   from ApidbTuning.${tblPrefix}Observations 
   where pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
   ) age,
   ApidbTuning.${tblPrefix}Participants pa, ApidbTuning.${tblPrefix}PartObsIO iov, ApidbTuning.${tblPrefix}ParticipantMD m, ApidbTuning.${tblPrefix}Observations obs
   where least(pa.EUPATH_0000152, \$\$visit_date.max\$\$, pa.EFO_0004950 + ( age.max_age * 365)) - 
       greatest(pa.EUPATH_0000151, \$\$visit_date.min\$\$, pa.EFO_0004950 + ( age.min_age * 365)) + 1 >= \$\$duration_observation\$\$
       and obs.pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
       and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
       and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
       and iov.observation_id = obs.pan_id
       and pa.pan_id = iov.participant_id
       and pa.pan_id = m.participant_id       
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select distinct m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
          ]]>
    </sql>
    </sqlQuery>


    <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('PCO_0000024','ENVO_01000744')
     ) 
 union
 select 'average_anopheles' as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, 'Average Female Anopheles Collected' as display_name, 'Average number of female Anopheles mosquitoes collected per house per night using CDC light traps set up once a month during the dates of this search' as description, null as variable_name, null as units, 'number' as type, 1 as is_range, null as variable_name
 null as precision, null as display_order from dual)
 where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
 order by display_order, display_name
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="clinicalVisitParams.visit_date" /> 
      <paramRef ref="participantParams.participants_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from  ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_id in (\$\$participants_${paramSuffix}\$\$)
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
 union all
 select distinct part.household_id as filter_item_id, part.part_id as internal, 'average_anopheles' as ontology_term_name, null as string_value, nvl(mos.avg_anoph,0) as number_value, null as date_value
 from (select da.pan_id, round(avg(nvl(EUPATH_0000192,0)+nvl(EUPATH_0000204,0)+nvl(EUPATH_0000205,0)),1) as avg_anoph
  from ApidbTuning.${tblPrefix}Households da, ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}LightTraps la
  where da.pan_id = io.input_pan_id
  and la.pan_id = io.output_pan_id
  and la.EUPATH_0020003 >= \$\$visit_date.min\$\$ 
  and la.EUPATH_0020003 <= \$\$visit_date.max\$\$ 
  group by da.pan_id) mos, part
  where part.household_id = mos.pan_id(+)
          ]]>
    </sql>    

    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
  with part as ( select distinct io.input_pan_id as household_id, io.output_pan_id as part_id
  from ApidbTuning.${tblPrefix}PANIO io
   where io.output_pan_type_source_id = 'EUPATH_0000096'
       and io.input_pan_type_source_id = 'PCO_0000024' )
 select distinct m.pan_id as filter_item_id, part.part_id as internal, m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}MetaData m, part
 where part.household_id = m.pan_id
 union all
 select distinct part.household_id as filter_item_id, part.part_id as internal, 'average_anopheles' as ontology_term_name, null as string_value, nvl(mos.avg_anoph,0) as number_value, null as date_value
 from (select io.input_pan_id as pan_id, round(avg(nvl(EUPATH_0000192,0)+nvl(EUPATH_0000204,0)+nvl(EUPATH_0000205,0)),1) as avg_anoph
  from ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}LightTraps la
  where io.input_pan_type_source_id = 'PCO_0000024'
  and io.output_pan_type_source_id = 'EUPATH_0000327'
  and la.pan_id = io.output_pan_id
  group by io.input_pan_id) mos, part
  where part.household_id = mos.pan_id(+)
          ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
        <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
        ]]>
      </sql>
    </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.visits_visitage_metadata_${paramSuffix}" />
         <paramRef ref="clinicalVisitParams.visit_date" /> 
         <paramRef ref="participantParams.households_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
with valid as (
select distinct io.output_pan_id as visit_id, io.input_pan_id as part_id
from ApidbTuning.${tblPrefix}PANIO io, ApidbTuning.${tblPrefix}Observations obs
where io.input_pan_id in (\$\$households_${paramSuffix}\$\$)
and io.output_pan_id in (\$\$visits_visitage_metadata_${paramSuffix}\$\$)
and obs.pan_id = io.output_pan_id
and obs.EUPATH_0000091 >= \$\$visit_date.min\$\$ 
and obs.EUPATH_0000091 <= \$\$visit_date.max\$\$ 
)
select distinct m.observation_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
 from ApidbTuning.${tblPrefix}ObservationMD m, valid
 where m.observation_id = valid.visit_id
/*
  union all
 select valid.visit_id as internal,  m.property_source_id as ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}MetaData m, valid, ApidbTuning.${tblPrefix}PANIO ios
where m.property_source_id = 'OBI_0100051'
and ios.output_pan_id = m.pan_id
and ios.input_pan_id = valid.visit_id
*/
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsMALED
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="geographic_region_maled" 
                       metadataQueryRef="ParticipantVQ.RegionMetaData_maled"
                       backgroundQueryRef="ParticipantVQ.RegionMetaData_maled"
                       ontologyQueryRef="ParticipantVQ.RegionOntology_maled"
                       countPredictsAnswerCount="true"
                       filterDataTypeDisplayName="Participants"
                       prompt="Geographic region"
                       dependedParamRef=""
                       trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
    </filterParam>

    <filterParam name="households_maled" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_maled"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_maled"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_maled"
                    filterDataTypeDisplayName="Household Observations"
                    countPredictsAnswerCount="true"
                    prompt="Household Observations"
                    dependedParamRef="participantParams.geographic_region_maled"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
      <help>
        Select participants based on the characteristics of the household where they live. 
      </help>
    </filterParam>
 
       <filterParam name="participants_maled" 
                      metadataQueryRef="ParticipantVQ.ParticipantMetaData_maled"
                      ontologyQueryRef="ParticipantVQ.ParticipantOntology_maled"
                      backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_maled"
                      countPredictsAnswerCount="true"
                      filterDataTypeDisplayName="Participants"
                      prompt="Personal characteristics"
                      trimMetadataTerms="${trimParticipantMetadataTerms}"
                      dependedParamRef="participantParams.households_maled">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_maled" 
                       metadataQueryRef="ParticipantVQ.VisitMetaData_maled"
                       ontologyQueryRef="ParticipantVQ.VisitOntology_maled"
                       backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_maled"
                       countPredictsAnswerCount="false"
                       prompt="Observations"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       dependedParamRef="participantParams.participants_maled">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesMALED
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
   <sqlQuery name="HouseholdOntology_maled" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
 select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, 
 nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in ('EUPATH_0000144') AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('PCO_0000024')
     )
     where ontology_term_name not in ('EUPATH_0000095')
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448') 
     order by display_order, display_name 
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_maled" isCacheable="false">
     <paramRef ref="participantParams.geographic_region_maled" />  
     <column name="ontology_term_name"/>
     <column name="internal"/>
     <column name="filter_item_id"/>
     <column name="number_value"/>
     <column name="date_value"/>
     <column name="string_value"/>
     <sql>
       <![CDATA[
                select  hp.participant_id as internal, h.household_observation_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
                from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
                where h.household_id in (\$\$geographic_region_maled\$\$)
                and h.household_id = hp.household_id 
       ]]>
     </sql>
   </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_maled" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
                select  hp.participant_id as internal, h.household_observation_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
                from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
                where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_maled" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
 select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'EUPATH_0000096'
     )
     where ontology_term_name != 'EUPATH_0000095'
     order by display_order, display_name 
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_maled" isCacheable="false">
     <paramRef ref="participantParams.households_maled" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_maled\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_maled" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_maled" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in ('NCBITaxon_2','NCBITaxon_2759','NCBITaxon_10239') AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in  ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in ('EUPATH_0000091','OBI_0001616','EUPATH_0010859','EUPATH_0010860','EUPATH_0010861','EUPATH_0010857')
     order by display_order, display_name 
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_maled" isCacheable="false">
         <paramRef ref="participantParams.participants_maled" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_maled\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_maled" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="RegionOntology_maled" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.variable_name, o.units,o.type,o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in ('GAZ_00000448')
order by display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_maled" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct h.household_id as internal, hp.participant_id as record_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
        ]]>
      </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsSCORE
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="study_arm_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.StudyArmOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Choose Study Arm"
                    dependedParamRef=""
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.RegionOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.RegionMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Villages"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_filter_${paramSuffix}"
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>
       
       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Village observations"
                    prompt="Villages"
                    dependedParamRef="participantParams.geographic_region_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Samples"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    sortLeavesBeforeBranches="false"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their sample characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesSCORE
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
   <sqlQuery name="StudyArmOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name in ('EUPATH_0010374','EUPATH_0015457','EUPATH_0030002')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="StudyArmMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name in ('EUPATH_0010374','EUPATH_0015457','EUPATH_0030002')
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="RegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.precision, o.variable_name, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted},'GAZ_00000448')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct hp.participant_id as internal, h.household_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
and hp.participant_id in (\$\$study_arm_filter_${paramSuffix}\$\$)
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="RegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct hp.participant_id as internal, h.household_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
        ]]>
      </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where hp.participant_id in (\$\$geographic_region_${paramSuffix}\$\$)
and h.household_id = hp.household_id 
and h.household_observation_id != h.household_id
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
and h.household_observation_id != h.household_id
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
o.parent_ontology_term_source_id as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsSCORENoVillage
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="study_arm_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.StudyArmOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Choose Study Arm"
                    dependedParamRef=""
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.RegionOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.RegionMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Villages"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_filter_${paramSuffix}"
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>
       
       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.geographic_region_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Samples"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    sortLeavesBeforeBranches="false"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their sample characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesSCORENoVillage
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
   <sqlQuery name="StudyArmOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name in ('EUPATH_0010374','EUPATH_0015457','EUPATH_0030002')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="StudyArmMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name in ('EUPATH_0010374','EUPATH_0015457','EUPATH_0030002')
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="RegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.precision, o.variable_name, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted},'GAZ_00000448')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct hp.participant_id as internal, h.household_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
and hp.participant_id in (\$\$study_arm_filter_${paramSuffix}\$\$)
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="RegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct hp.participant_id as internal, h.household_id as filter_item_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
        ]]>
      </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$geographic_region_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
o.parent_ontology_term_source_id as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, participant_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, participant_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsMalawi
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="case_control_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.CaseControlOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.CaseControlMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.CaseControlMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Households"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_${paramSuffix}"
                    trimMetadataTerms="true">
         <help>
           Select participants based on whether they are cases or controls. 
         </help>
       </filterParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.GeographicRegionOntology_${paramSuffix}" 
                       metadataQueryRef="ParticipantVQ.GeographicRegionMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.GeographicRegionMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Participants"
                       prompt="Study Site"
                       trimMetadataTerms="true"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.case_control_filter_${paramSuffix}">
         <help>
           Select participants based on their study site.
         </help>
       </filterParam>

       <filterParam name="household_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                       prompt="Household"
                       trimMetadataTerms="${trimHouseholdMetadataTerms}"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.geographic_region_${paramSuffix}">
         <help>
           Select participants based on household characteristics. 
         </help>
       </filterParam>
       
       <filterParam name="participant_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Participants"
                       prompt="Participant"
                       trimMetadataTerms="${trimParticipantMetadataTerms}"
                       countPredictsAnswerCount="true"
                       dependedParamRef="participantParams.household_${paramSuffix}">
         <help>
           Select participants based on their personal characteristics. 
         </help>
       </filterParam>

       <filterParam name="event_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ObservationOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.ObservationMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ObservationMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Observations"
                       prompt="Observations"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       countPredictsAnswerCount="false"
                       dependedParamRef="participantParams.participant_${paramSuffix}">
         <help>
           Select participants based on variables associated with their enrollment or followup events. 
         </help>
       </filterParam>       

      <filterParam name="relative_event_${paramSuffix}" 
                       ontologyQueryRef="ParticipantVQ.ObservationOntology_${paramSuffix}"
                       metadataQueryRef="ParticipantVQ.RelativeCasecontrolObservationMetaData_${paramSuffix}"
                       backgroundQueryRef="ParticipantVQ.ObservationMetaDataBkg_${paramSuffix}"
                       filterDataTypeDisplayName="Observations"
                       prompt="Related Case or Control"
                       trimMetadataTerms="${trimObservationMetadataTerms}"
                       countPredictsAnswerCount="false"
                       dependedParamRef="participantParams.case_control_filter_${paramSuffix}">
         <help>
           Modify participants selected based on information about their related case or control. 
         </help>
       </filterParam>    
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesMalawi
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=microbiomeOntologyQueryFull
prop=participantMicrobiomeMetadataQueryFull
prop=participantMicrobiomeMetadataBkgQueryFull
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

    <sqlQuery name="CaseControlOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.precision, o.variable_name, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     where ontology_term_source_id = 'EUPATH_0010375')
          ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="CaseControlMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal,  ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0010375'
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="CaseControlMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select participant_id as internal,  ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0010375'
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="GeographicRegionOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.precision, o.variable_name, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in ('GAZ_00000448')
     order by display_order, display_name
          ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="GeographicRegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.case_control_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.household_id as internal, hp.participant_id as record_id,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and m.household_id = hp.household_id 
and hp.participant_id in (\$\$case_control_filter_${paramSuffix}\$\$)
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="GeographicRegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.household_id as internal, hp.participant_id as record_id,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and m.household_id = hp.household_id  
          ]]>
    </sql>    
    </sqlQuery>
    
    <sqlQuery name="HouseholdOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.units,o.is_range,o.variable_name, o.precision,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'PCO_0000024'
) where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
                  select hp.participant_id as internal,  m.household_observation_id as filter_item_id,
                  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where hp.household_id in (\$\$geographic_region_${paramSuffix}\$\$)
and m.household_id = hp.household_id 
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select hp.participant_id as internal,  m.household_observation_id as filter_item_id,
                  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}HouseholdMD m, ApidbTuning.${tblPrefix}HousePartIO hp
where m.household_id = hp.household_id 
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ParticipantOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id = 'EUPATH_0000096'
) where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.household_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
where m.participant_id in (\$\$household_${paramSuffix}\$\$)
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select m.participant_id as internal,  m.ontology_term_name, m.string_value, m.number_value, m.date_value
from ApidbTuning.${tblPrefix}ParticipantMD m
         ]]>
      </sql>    
    </sqlQuery>

    <sqlQuery name="ObservationOntology_${paramSuffix}">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
select * from (
select o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name, o.variable_name, o.description, 
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type, 
o.units, o.precision, o.is_range, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in  ('EUPATH_0000738','EUPATH_0000609')
${microbiomeOntologyQueryFull}
) where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
order by display_order, display_name
      </sql>
    </sqlQuery>

    <sqlQuery name="ObservationMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.participant_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participant_${paramSuffix}\$\$)
${participantMicrobiomeMetadataQueryFull}
          ]]>
    </sql>    
    </sqlQuery>

    <sqlQuery name="ObservationMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, sub_observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
${participantMicrobiomeMetadataBkgQueryFull}
          ]]>
    </sql>    
    </sqlQuery>

    <sqlQuery name="RelativeCasecontrolObservationMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.case_control_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, observation_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id not in (\$\$case_control_filter_${paramSuffix}\$\$)
          ]]>
    </sql>    
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsPerch
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
        <flatVocabParam name="case_control_${paramSuffix}"
               prompt="Study Arm"
               multiPick="true"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.caseControl_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

        <flatVocabParam name="study_arm_${paramSuffix}"
               prompt="Study Arm"
               multiPick="false"
               quote="true"
               visible="true"
               dependedParamRef=""
               queryRef="ParticipantVQ.StudyArm_${paramSuffix}">
      <help>You may choose to limit your search to a specific study arm.</help>
    </flatVocabParam>

       <filterParam name="case_control_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.CaseControlOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.CaseControlMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.CaseControlMetaData_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Case Control"
                    prompt="Cases or Controls"
                    dependedParamRef=""
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="geographic_region_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.RegionOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.RegionMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.RegionMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Households"
                    prompt="Geographic region"
                    dependedParamRef="participantParams.study_arm_${paramSuffix},participantParams.case_control_filter_${paramSuffix}"
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>
       
       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef="participantParams.geographic_region_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesPerch
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=rmRegionSqlCommentStart
prop=rmRegionSqlCommentEnd
prop=hideRegionVarsSqlCommentStart
prop=hideRegionVarsSqlCommentEnd
>templateTextStart<
        <sqlQuery name="StudyArm_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'Any Study Arm' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0015457')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

        <sqlQuery name="caseControl_${paramSuffix}">
          <column name="display" />
          <column name="internal" />
          <column name="term" />
          <sql>
         <![CDATA[
SELECT * from (
SELECT 'All' as display, 'AnY' as term, 'AnY' as internal, 1 as ordernum from dual
UNION
select distinct initcap(string_value) as display, string_value as term, string_value as internal, 2 as ordernum
from apidbtuning.${tblPrefix}ParticipantMD
where ontology_term_name = 'EUPATH_0010375')
order by ordernum,display
            ]]>
            </sql>
        </sqlQuery>

   <sqlQuery name="CaseControlOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name in ('EUPATH_0000096','EUPATH_0010375','EUPATH_0033155')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="CaseControlMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  household_id as internal, participant_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name in ('EUPATH_0010375','EUPATH_0033155')
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="RegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.precision, o.variable_name, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448' )
     where ontology_term_name not in ('GAZ_00000448')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="RegionMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_${paramSuffix}" />  
      <paramRef ref="participantParams.case_control_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct h.household_id as internal, hp.participant_id as record_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id in (\$\$case_control_filter_${paramSuffix}\$\$)
and h.household_id = hp.household_id 
and ('AnY' = \$\$study_arm_${paramSuffix}\$\$
       or hp.participant_id in (select participant_id
       from ApidbTuning.${tblPrefix}ParticipantMD
       where ontology_term_name = 'EUPATH_0015457'
       and string_value = \$\$study_arm_${paramSuffix}\$\$))
        ]]>
      </sql>
    </sqlQuery>

    <sqlQuery name="RegionMetaDataBkg_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  distinct h.household_id as internal, hp.participant_id as record_id, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.ontology_term_name in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
and h.household_id = hp.household_id 
        ]]>
      </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     ${rmRegionSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${rmRegionSqlCommentEnd}
     ${hideRegionVarsSqlCommentStart}
     and ontology_term_name not in (select ontology_term_source_id from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448')
     ${hideRegionVarsSqlCommentEnd}
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.geographic_region_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where hp.household_id in (\$\$geographic_region_${paramSuffix}\$\$)
and h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="HouseholdMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesUMSP
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
prop=tblPrefix
prop=paramSuffix
>templateTextStart<
   <sqlQuery name="DateRegionOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
      <![CDATA[
select * from (
select o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, o.display_name, o.description, o.units,o.type,o.is_range,o.variable_name, o.precision, 2 as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'GAZ_00000448'
UNION
select ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name, display_name, description, units,type,is_range, variable_name, precision, 1 as display_order
from ApidbTuning.${tblPrefix}Ontology 
     where ontology_term_source_id =  'EUPATH_0000091'
)
     where ontology_term_name not in ('GAZ_00000448')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name,
CASE WHEN o.ontology_term_source_id in ('EUPATH_0000609') THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
UNION
select distinct ontology_term_source_id as ontology_term_name,
'EUPATH_0000738' as parent_ontology_term_name, 
nvl(display_name,ontology_term_name) as display_name,description, variable_name, units, type,
is_range,precision,0.05 as display_order
from ApidbTuning.${tblPrefix}Ontology
where ontology_term_source_id = 'PATO_0000047'
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

>templateTextEnd<

[templateStart]
name=participantFilterParamsPROVIDE
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef=""
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>

       <filterParam name="samples_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.SampleOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.SampleMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.SampleMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    prompt="Samples"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.visits_${paramSuffix}">
         <help>
           Select participants based on their sample characteristics. 
         </help>
       </filterParam>
 
>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesPROVIDE
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
>templateTextStart<
   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
and sample_id = observation_id
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where sample_id = observation_id
          ]]>
    </sql>
    </sqlQuery>

 <sqlQuery name="SampleOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="SampleMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.visits_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  participant_id as record_id, observation_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where observation_id in (\$\$visits_${paramSuffix}\$\$)
and sample_id != observation_id
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="SampleMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  participant_id as record_id, observation_id as internal, sample_id as filter_item_id, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where sample_id != observation_id
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsPROVIDE2
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="study_arm_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.StudyArmOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Choose Study Arm"
                    dependedParamRef=""
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef="participantParams.study_arm_filter_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on the characteristics of their household. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix},participantParams.study_arm_filter_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesPROVIDE2
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
>templateTextStart<
   <sqlQuery name="StudyArmOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name in ('EUPATH_0036422','EUPATH_0036429')
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="StudyArmMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where ontology_term_name in ('EUPATH_0036422','EUPATH_0036429')
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
and hp.participant_id in (\$\$study_arm_filter_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp
where h.household_id = hp.household_id 
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
     <paramRef ref="participantParams.households_${paramSuffix}" />  
     <paramRef ref="participantParams.study_arm_filter_${paramSuffix}" />  
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
where participant_id in (\$\$households_${paramSuffix}\$\$)
and participant_id in (\$\$study_arm_filter_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  participant_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ParticipantMD
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  observation_id as filter_item_id, participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where participant_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as filter_item_id, participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

[templateStart]
name=participantFilterParamsWASHB
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdFilterDataTypeDisplayName
prop=trimHouseholdMetadataTerms
prop=trimParticipantMetadataTerms
prop=trimObservationMetadataTerms
>templateTextStart<
       <filterParam name="study_arm_filter_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.StudyArmOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.StudyArmMetaData_${paramSuffix}"
                    countPredictsAnswerCount="true"
                    filterDataTypeDisplayName="Households"
                    prompt="Choose Study Arm"
                    dependedParamRef=""
                    trimMetadataTerms="true">
         <help>
           Select participants based on their geographic region. 
         </help>
       </filterParam>

       <filterParam name="households_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.HouseholdOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.HouseholdMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.HouseholdMetaDataBkg_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    filterDataTypeDisplayName="${householdFilterDataTypeDisplayName}"
                    prompt="Households"
                    dependedParamRef="participantParams.study_arm_filter_${paramSuffix}"
                    trimMetadataTerms="${trimHouseholdMetadataTerms}">
         <help>
           Select participants based on the characteristics of their household. 
         </help>
       </filterParam>

       <filterParam name="participants_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.ParticipantOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.ParticipantMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.ParticipantMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    filterDataTypeDisplayName="Participants"
                    prompt="Personal characteristics"
                    trimMetadataTerms="${trimParticipantMetadataTerms}"
                    dependedParamRef="participantParams.households_${paramSuffix}">
         <help>
              Select participants based on their characteristics. 
         </help>
       </filterParam>

       <filterParam name="visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaData_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    countPredictsAnswerCount="false"
                    prompt="Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="participantParams.participants_${paramSuffix}">
         <help>
           Select participants based on their visit characteristics. 
         </help>
       </filterParam>
 
       <filterParam name="relative_visits_${paramSuffix}" 
                    ontologyQueryRef="ParticipantVQ.VisitOntology_${paramSuffix}"
                    metadataQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    backgroundQueryRef="ParticipantVQ.VisitMetaDataBkgd_${paramSuffix}"
                    prompt="Related Observations"
                    trimMetadataTerms="${trimObservationMetadataTerms}"
                    dependedParamRef="">
         <help>
           Select related observations based on their characteristics. 
         </help>
       </filterParam>

>templateTextEnd<

[templateStart]
name=participantFilterParamQueriesWASHB
anchorFile=ClinEpiModel/Model/lib/dst/participantParams.dst
prop=tblPrefix
prop=paramSuffix
prop=householdMultiFilterIdsQuoted
prop=householdFilterExcludedIdsQuoted
prop=participantMultiFilterIdsQuoted
prop=participantFilterExcludedIdsQuoted
prop=observationMultiFilterIdsQuoted
prop=observationFilterExcludedIdsQuoted
>templateTextStart<
   <sqlQuery name="StudyArmOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, cast(null as varchar2(1)) as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     where o.ontology_term_source_id in ('EUPATH_0035014','EUPATH_0035092','EUPATH_0035016') )
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="StudyArmMetaData_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as record_id, po.observation_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp, ApidbTuning.${tblPrefix}PartObsIO po
where h.ontology_term_name in ('EUPATH_0035014','EUPATH_0035016')
and h.household_id = hp.household_id
and hp.participant_id = po.participant_id
UNION ALL
select  distinct h.household_observation_id as filter_item_id, po.participant_id as record_id, o.observation_id as internal, o.ontology_term_name, o.string_value, o.number_value, o.date_value
from ApidbTuning.${tblPrefix}ObservationMD o, ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp, ApidbTuning.${tblPrefix}PartObsIO po
where o.ontology_term_name in ('EUPATH_0035092')
and hp.participant_id = po.participant_id 
and o.observation_id = po.observation_id
and hp.household_id = h.household_id
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${householdMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'PCO_0000024'
     )
     where ontology_term_name not in (${householdFilterExcludedIdsQuoted})
     order by display_order, display_name
     ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="HouseholdMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.study_arm_filter_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as record_id, po.observation_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp, ApidbTuning.${tblPrefix}PartObsIO po
where po.observation_id in (\$\$study_arm_filter_${paramSuffix}\$\$)
and hp.participant_id = po.participant_id 
and h.household_id = hp.household_id
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="HouseholdMetaDataBkg_${paramSuffix}" isCacheable="false">
     <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  distinct h.household_observation_id as filter_item_id, hp.participant_id as record_id, po.observation_id as internal, h.ontology_term_name, h.string_value, h.number_value, h.date_value
from ApidbTuning.${tblPrefix}HouseholdMD h, ApidbTuning.${tblPrefix}HousePartIO hp, ApidbTuning.${tblPrefix}PartObsIO po
where hp.participant_id = po.participant_id 
and h.household_id = hp.household_id
          ]]>
    </sql>
    </sqlQuery>

   <sqlQuery name="ParticipantOntology_${paramSuffix}" isCacheable="true">
     <column name="ontology_term_name"/>
     <column name="parent_ontology_term_name"/>
     <column name="display_name"/>
     <column name="description"/>
     <column name="variable_name"/>
     <column name="type"/>
     <column name="units"/>
     <column name="precision"/>
     <column name="is_range"/>
    <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, o.parent_ontology_term_source_id as parent_ontology_term_name,
nvl(o.display_name,o.ontology_term_name) as display_name, o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${participantMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range, o.precision, o.display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id =  'EUPATH_0000096'
     )
     where ontology_term_name not in (${participantFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

   <sqlQuery name="ParticipantMetaData_${paramSuffix}" isCacheable="false">
      <paramRef ref="participantParams.households_${paramSuffix}" />  
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  p.participant_id as filter_item_id, p.participant_id as record_id, po.observation_id as internal, p.ontology_term_name, p.string_value, p.number_value, p.date_value
from ApidbTuning.${tblPrefix}ParticipantMD p, ApidbTuning.${tblPrefix}PartObsIO po
where po.observation_id in (\$\$households_${paramSuffix}\$\$)
and po.participant_id = p.participant_id
          ]]>
    </sql>
    </sqlQuery>

    <sqlQuery name="ParticipantMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="filter_item_id"/>
      <column name="record_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
         <![CDATA[
select  p.participant_id as filter_item_id, p.participant_id as record_id, po.observation_id as internal, p.ontology_term_name, p.string_value, p.number_value, p.date_value
from ApidbTuning.${tblPrefix}ParticipantMD p, ApidbTuning.${tblPrefix}PartObsIO po
where po.participant_id = p.participant_id
          ]]>
    </sql>
    </sqlQuery>

    
    <sqlQuery name="VisitOntology_${paramSuffix}" isCacheable="true">
      <column name="ontology_term_name"/>
      <column name="parent_ontology_term_name"/>
      <column name="display_name"/>
      <column name="description"/>
      <column name="variable_name"/>
      <column name="type"/>
      <column name="units"/>
      <column name="precision"/>
      <column name="is_range"/>
      <sql>
         <![CDATA[
select * from (
select distinct o.ontology_term_source_id as ontology_term_name, 
CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 'EUPATH_0000738' ELSE o.parent_ontology_term_source_id END as parent_ontology_term_name, 
nvl(o.display_name,o.ontology_term_name) as display_name,o.description, o.variable_name, o.units,
CASE WHEN o.ontology_term_source_id in (${observationMultiFilterIdsQuoted}) AND o.type is null THEN 'multiFilter' ELSE o.type END as type,
o.is_range,o.precision,CASE WHEN o.ontology_term_source_id = 'EUPATH_0000609' THEN 0.1 ELSE o.display_order END as display_order
from ApidbTuning.${tblPrefix}Ontology o
     CONNECT BY o.parent_ontology_term_source_id = PRIOR o.ontology_term_source_id
     START WITH o.ontology_term_source_id in ('EUPATH_0000738','EUPATH_0000609')
     )
     where ontology_term_name not in (${observationFilterExcludedIdsQuoted})
     order by display_order, display_name
         ]]>
    </sql>
   </sqlQuery>

       <sqlQuery name="VisitMetaData_${paramSuffix}" isCacheable="false">
         <paramRef ref="participantParams.participants_${paramSuffix}" />  
         <column name="ontology_term_name"/>
         <column name="internal"/>
         <column name="record_id"/>
         <column name="filter_item_id"/>
         <column name="number_value"/>
         <column name="date_value"/>
         <column name="string_value"/>
         <sql>
           <![CDATA[
select  observation_id as filter_item_id, participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
where observation_id in (\$\$participants_${paramSuffix}\$\$)
          ]]>
    </sql>
    </sqlQuery>    

    <sqlQuery name="VisitMetaDataBkgd_${paramSuffix}" isCacheable="false">
      <column name="ontology_term_name"/>
      <column name="internal"/>
      <column name="record_id"/>
      <column name="filter_item_id"/>
      <column name="number_value"/>
      <column name="date_value"/>
      <column name="string_value"/>
      <sql>
        <![CDATA[
select  observation_id as filter_item_id, participant_id as record_id, observation_id as internal, ontology_term_name, string_value, number_value, date_value
from ApidbTuning.${tblPrefix}ObservationMD
          ]]>
    </sql>
    </sqlQuery>
>templateTextEnd<

